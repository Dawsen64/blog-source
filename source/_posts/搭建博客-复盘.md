---
title: 搭建博客-复盘
date: 2025-11-27
updated: 2025-11-27
type: artile
---


### 🏛️ 一、 核心架构 (我们造了什么？)

我们采用的是 **“中央厨房模式 (Cloud Build)”**。

- **本地 (你的电脑):** 只负责写文章（切菜）、推代码（下单）。
- **GitHub (仓库):** 负责存储你的菜谱和原材料（源代码）。
- **Cloudflare (大厨):** 自动感知 GitHub 的变动，在云端现场安装 Hexo，现场生成网页，并分发到全球。

---

### 📋 二、 标准搭建流程 (SOP)

#### 1\. 地基与原材料 (本地环境)

- **安装:** Node.js (LTS版) 和 Git。
- **建站:** `npm install -g hexo-cli` -> `hexo init Blog`。
- **主题:** 使用官方源 `git clone https://github.com/jerryc05/hexo-theme-butterfly.git themes/butterfly`。
- **依赖:** `npm install` (安装 package.json 里的零件) + `npm install hexo-renderer-pug hexo-renderer-stylus --save` (主题插件)。

#### 2\. 净化与合规 (最关键的一步)

- **清理:** 删除 `public` 文件夹，删除 `.deploy_git` 文件夹。
- **斩断:** **必须删除** `themes/butterfly` 下的 `.git` 文件夹 (防止 Git 子模块冲突)。
- **配置:** 修改 `_config.yml` 启用主题。

#### 3\. 上传军火库 (GitHub)

- 创建空仓库 `blog-source`。
- 执行 Git 三连：`git add .` -> `git commit -m "init"` -> `git push`。
- **验收标准:** GitHub 上的 `themes/butterfly` 文件夹点进去**必须**有内容。

#### 4\. 雇佣云端大厨 (Cloudflare Pages)

- 入口：`Workers & Pages` -> `Create application` -> **切换到 `Pages` 标签页** -> `Connect to Git`。
- **构建配置 (手动修正版):**

  - 命令: `npx hexo generate` (注意是 npx 开头)。
  - 目录: `public`。

- **环境变量:**

  - `NODE_VERSION`: `18`。

#### 5\. 挂牌营业 (DNS)

- **避坑:** **不要**在 Cloudflare 首页添加站点（Add Site）。
- **正解:** 在 Pages 项目 -> `Custom domains` 添加 `www.你的域名.com`。
- **解析:** 去阿里云/DNSPod 添加 `CNAME` 记录指向 `xxx.pages.dev`。

---

### 💣 三、 审计官的“排雷”黑名单 (必看!)

回顾我们的对话，以下是你掉进去过的坑，以后严禁再犯：

1.  **严禁“双重 Git”:**

    - **现象:** 主题文件夹上传后是灰色的/空的。
    - **原因:** 没删主题文件夹里的 `.git`。
    - **后果:** 网页白屏，无样式。

2.  **严禁“入口走错”:**

    - **现象:** 看到 `Wrangler`，或者看到 `Error 1001`。
    - **纠正:** 永远只认准 **Workers & Pages** 菜单下的 **Pages (页面)** 标签。不要去首页添加域名。

3.  **严禁“命令缺失”:**

    - **现象:** 云端报错 `hexo: not found`。
    - **纠正:** 云端必须用 `npx hexo generate`，因为云端没有管理员权限给你全局安装 Hexo。

4.  **严禁“本地构建混用”:**

    - **纪律:** 既然选了云端版，就**忘掉** `hexo g` 和 `hexo d`。你以后只需要 `git push`。

---

### ✍️ 四、 你以后的日常 (写博客流程)

从今天起，你想发文章只需要做这 3 步：

1.  **写:** 在电脑上 `source/_posts` 里新建 `.md` 文件写文章。
2.  **推:** 在博客根目录右键 Git Bash:

    Bash

    ```
    git add .
    git commit -m "写了篇新文章"
    git push
    ```

3.  **看:** 等 2 分钟，访问你的域名，文章就出来了。
